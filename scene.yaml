settings:
    localization:
        #- &text_loc_country function() { return feature["name"]; }
        - &text_loc_country function() { return feature["name:en"] || feature["name"]; }
    labels:
        - &text_family_places Arial
        - &text_family_water  Arial
        - &text_fill_places [1, 1, 1]
        - &text_fill_water  [.65, 1, .95]
        - &text_stroke_places { color: [0, 0, 0], width: 2 }
        - &text_stroke_water  { color: [0, 0, 0], width: 2 }
    exceptions:
        - &small_countries [Luxembourg, San Marino, Citt√† del Vaticano, Andorra, Jersey, Guernsey]

sources:
    sat:
        type: Raster
        url: http://tile.sentinelmap.eu/16/8/{z}/{x}/{y}.jpg
        min_zoom: 6
        max_zoom: 14
        bounds: [0.0000, 40.9799, 16.87499, 52.48278] # [w, s, e, n]
    osm:
        type: TopoJSON
        url: http://tile.mapzen.com/mapzen/vector/v1/all/{z}/{x}/{y}.topojson?api_key=vector-tiles-Y3DcPK9
        max_zoom: 16

styles:
    sat-raster:
        base: raster
    osm-lines:
        base: lines
        blend: overlay
        blend_order: 0 # under text
    osm-text:
        base: text
        blend: overlay
        blend_order: 1 # top of text

scene:
    background:
        color: [.75, .75, .75]

layers:
    terrain:
        data: { source: sat }
        draw:
            sat-raster:
                order: 0
    boundaries:
        data: { source: osm }
        adminlines_0:
            filter:
                kind: country
            draw:
                osm-lines:
                    order: 2
                    width: 2.5px
                    color: [.75, .75, .75, .375]
        adminlines_1:
            filter:
                kind: region
                $zoom: { min: 9 }
            draw:
                osm-lines:
                    order: 2
                    width: 1.5px
                    color: [.75, .75, .75, .375]
    places:
        data: { source: osm }
        countries_0:
            filter:
                kind: [country]
                name: true
                $zoom: { max: 7 }
            draw:
                osm-text:
                    buffer: 10px
                    visible: true
                    text_source: *text_loc_country
                    font:
                        size: 15px
                        weight: bold
                        transform: uppercase
                        family: *text_family_places
                        fill: *text_fill_places
                        stroke: *text_stroke_places
            tosmall:
                filter:
                    name: *small_countries
                draw:
                    osm-text:
                        visible: false
        countries_1:
            filter:
                kind: [country]
                name: true
                $zoom: { min: 7, max: 9 }
            draw:
                osm-text:
                    buffer: 10px
                    visible: true
                    text_source: *text_loc_country
                    font:
                        size: 15px
                        weight: bold
                        transform: uppercase
                        family: *text_family_places
                        fill: *text_fill_places
                        stroke: *text_stroke_places
        countries_2:
            filter:
                kind: [country]
                name: *small_countries
                $zoom: { min: 9, max: 13 }
            draw:
                osm-text:
                    buffer: 10px
                    visible: true
                    text_source: *text_loc_country
                    font:
                        size: 15px
                        weight: bold
                        transform: uppercase
                        family: *text_family_places
                        fill: *text_fill_places
                        stroke: *text_stroke_places

    water:
        data: { source: osm }
        waternames_0:
            filter:
                kind: [ocean, sea]
            draw:
                osm-text:
                    buffer: 10px
                    font:
                        size: 12.5px
                        weight: bold
                        transform: uppercase
                        family: *text_family_water
                        fill: *text_fill_water
                        stroke: *text_stroke_water
        waternames_1:
            filter:
                all:
                    - kind: lake
                any:
                    - { $zoom: { min: 6 },  area: { min: 500000000 } }
                    - { $zoom: { min: 7 },  area: { min: 160000000 } }
                    - { $zoom: { min: 8 },  area: { min: 40000000 } }
                    - { $zoom: { min: 9 },  area: { min: 10000000 } }
                    - { $zoom: { min: 10 }, area: { min: 8000000 } }
                    - { $zoom: { min: 11 }, area: { min: 2000000 } }
                    - { $zoom: { min: 12 }, area: { min: 200000 } }
                    - { $zoom: { min: 13 }, area: { min: 100000 } }
                    - { $zoom: { min: 14 }, area: { min: 2000 } }
            draw:
                osm-text:
                    buffer: 10px
                    font:
                        size: 10px
                        weight: bold
                        transform: uppercase
                        family: *text_family_water
                        fill: *text_fill_water
                        stroke: *text_stroke_water
        waternames_2:
            filter:
                kind: river
                $zoom: { min: 10 }
            draw:
                osm-text:
                    buffer: 10px
                    font:
                        size: 10px
                        family: *text_family_water
                        fill: *text_fill_water
                        stroke: *text_stroke_water
        waternames_3:
            filter:
                kind: canal
                $zoom: { min: 12 }
            draw:
                osm-text:
                    buffer: 10px
                    font:
                        size: 10px
                        family: *text_family_water
                        fill: *text_fill_water
                        stroke: *text_stroke_water
        waterlines_0:
            filter:
                kind: ocean
                $zoom: { max: 9 }
            draw:
                osm-lines:
                    order: 1
                    width: 2.0px
                    color: |
                        function() {
                            var a = 1 - ($zoom / 16)
                            return [0, .5, .6, a];
                        }
        waterlines_1:
            filter:
                kind: lake
            draw:
                osm-lines:
                    order: 1
                    width: 1.0px
                    color: |
                        function() {
                            var a = 1 - ($zoom / 16)
                            return [0, .5, .6, a];
                        }
        waterlines_2:
            filter:
                kind: [river, water]
            draw:
                osm-lines:
                    order: 1
                    width: 1.0px
                    color: |
                        function() {
                            var a = 1 - ($zoom / 16)
                            return [0, .5, .6, a];
                        }
        waterlines_3:
            filter:
                kind: canal
                $zoom: { min: 11 }
            draw:
                osm-lines:
                    order: 1
                    width: 1.0px
                    color: |
                        function() {
                            var a = 1 - ($zoom / 16)
                            return [0, .5, .6, a];
                        }
